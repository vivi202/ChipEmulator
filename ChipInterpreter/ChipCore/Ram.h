//
// Created by vincenzo on 28/09/22.
//

#ifndef CHIPEMULATOR_RAM_H
#define CHIPEMULATOR_RAM_H

#include "ResettableComponent.h"
#include <array>
#include <cstdint>
class Ram :public ResettableComponent{
public:
    //chip8 can address memory from 0x000 to 0xFFF
    Ram();
    static const int MEMORY_SIZE=4096;
    static const int FONT_START_ADDRESS=0x000;
    static const int FONT_OFFSET=0x5;
    //space occupied by default font in bytes.
    static const int FONT_SIZE=80;
    void reset() override;
    void write(uint16_t address,uint8_t value);
    uint8_t read(uint16_t address)const;
private:
    //array that contains font sprites to load them in memory.
    std::array<uint8_t,FONT_SIZE>fontSprites={
            0xF0,0x90,0x90,0x90,0xF0,//0
            0x20,0x60,0x20,0x20,0x70,//1
            0xF0,0x10,0xF0,0x80,0xF0,//2
            0xF0,0x10,0xF0,0x10,0xF0,//3
            0x90,0x90,0xf0,0x10,0x10,//4
            0xF0,0x80,0xF0,0x10,0xF0,//5
            0xF0,0x80,0xF0,0x90,0xF0,//6
            0xF0,0x10,0x20,0x40,0x40,//7
            0xF0,0x90,0xF0,0x90,0xF0,//8
            0xF0,0x90,0xF0,0x10,0xF0,//9
            0xF0,0x90,0xF0,0x90,0x90,//A
            0xE0,0x90,0xE0,0x90,0xE0,//B
            0xF0,0x80,0x80,0x80,0xF0,//C
            0xE0,0x90,0x90,0x90,0xE0,//D
            0xF0,0x80,0xF0,0x80,0xF0,//E
            0xF0,0x80,0xF0,0x80,0x80 //F
    };

    void loadFontSprites();
    std::array<uint8_t,MEMORY_SIZE>memory{};
};


#endif //CHIPEMULATOR_RAM_H
